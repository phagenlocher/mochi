decl x[10], y[10], z[20], rand[2], done[2];

x := 0;
y := 0;
z := 2;
rand := 0;
done := 0;

beginprocess
	await rand = 1;
	while rand = 1 do x := x+1;
endprocess

beginprocess
	await rand = 1;
	while rand = 1 do y := y+1;
endprocess

beginprocess
	await z = 1;
	while done = 0 do 
	{
		z := (x+y)-z;
		x := x-1;
		y := y-1;
		if z = 0 then
			done := 1;
		else
			skip;
	}
endprocess

beginprocess
	rand := 1;
	skip;
	rand := 0;
	_z1: z := 1;
	await done = 1;
endprocess

_ap0: z = 0;
_ap1: z = 2;
