decl x[20], flag1[2], flag2[2], halt[2], rand[2];

x := 0;
flag1 := 0;
flag2 := 0;
halt := 0;
rand := 0;

beginprocess
	await rand = 1;
	while rand = 1 do x := x+1;
	_randend: skip;
endprocess

beginprocess
	while halt = 0 do
	{
		await (flag1 = 1);
		while not (x <= 10) do x := x-10;
		flag1 := 0;
	}
endprocess

beginprocess
	while halt = 0 do
	{
		await (flag2 = 1);
		while not (x <= 7) do x := x-7;
		flag2 := 0;
	}
endprocess

beginprocess
	rand := 1;
	skip;
	rand := 0;
	while not (x = 0) do
	{
		flag1 := 1;
		await flag1 = 0;
		flag2 := 1;
		await flag2 = 0;
		if x = 0 then 
			skip;
		else { 
			x := x + 1;
		}
	}
	_end: skip;
	halt := 1;
	flag1 := 1;
	flag2 := 1;
endprocess

_x0: x=0;
